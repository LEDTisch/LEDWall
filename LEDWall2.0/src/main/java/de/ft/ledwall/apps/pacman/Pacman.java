package de.ft.ledwall.apps.pacman;

import de.ft.ledwall.Application;
import de.ft.ledwall.Sound;
import de.ft.ledwall.SystemInterface;
import org.jetbrains.annotations.NotNull;

import java.util.ArrayList;
import java.util.concurrent.TimeUnit;

public class Pacman implements Application {
    String Sound_intro="PacManSounds/game_start.wav";
    Level level=new Level();
    int drawcounter=0;
    int level1[][]={
            {0x04,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x04},
            {0x02,0x01,0x01,0x01,0x01,0x02,0x01,0x01,0x01,0x02},
            {0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02},
            {0x01,0x01,0x02,0x01,0x01,0x01,0x01,0x02,0x01,0x01},
            {0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02},
            {0x01,0x02,0x01,0x02,0x01,0x01,0x02,0x01,0x02,0x01},
            {0x02,0x02,0x01,0x02,0x01,0x02,0x02,0x01,0x02,0x02},
            {0x02,0x01,0x01,0x02,0x01,0x01,0x02,0x01,0x01,0x02},
            {0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02},
            {0x01,0x01,0x02,0x01,0x01,0x02,0x01,0x01,0x01,0x01},
            {0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02},
            {0x02,0x01,0x01,0x01,0x01,0x02,0x01,0x01,0x01,0x02},
            {0x02,0x02,0x02,0x02,0x01,0x02,0x01,0x02,0x02,0x02},
            {0x01,0x01,0x01,0x02,0x01,0x02,0x01,0x02,0x01,0x02},
            {0x04,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x02,0x04}
    };
    @Override
    public void onCreate() {
        newGame();
    }

    void newGame(){
        level.setLevel(level1);
        level.player.setMyLevel(level);
        level.player.setNextDirection(Direction.NONE);
        Sound.play(this.Sound_intro);
    }

    @Override
    public void onDraw() {
        SystemInterface.table.clear();
        level.draw();
        level.player.draw();
        for(int i=0;i<level.ghosts.size();i++){
            level.ghosts.get(i).draw();
        }
        if(drawcounter>3){
            level.player.move();
            for(int i=0;i<level.ghosts.size();i++){
                level.ghosts.get(i).move();
            }
            drawcounter=0;
        }
        drawcounter++;
    }

    @Override
    public void onRun() {

    }

    @Override
    public void onDataReceive(@NotNull String data, int playerID) {

        if(data.contentEquals("d")){
            level.player.setNextDirection(Direction.DOWN);
        }
        if(data.contentEquals("u")){
            level.player.setNextDirection(Direction.UP);
        }
        if(data.contentEquals("r")){
            level.player.setNextDirection(Direction.RIGHT);
        }
        if(data.contentEquals("l")){
            level.player.setNextDirection(Direction.LEFT);
        }
    }

    @NotNull
    @Override
    public String getName() {
        return "PacMan";
    }

    @Override
    public void onStop() {

    }
}
